
<!DOCTYPE html>
<html lang="pt_br">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="http://localhost:8000/theme/stylesheet/style.min.css">


  <link rel="stylesheet" type="text/css" href="http://localhost:8000/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="http://localhost:8000/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="http://localhost:8000/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="http://localhost:8000/theme/font-awesome/css/solid.css">







<meta name="author" content="André Thiago" />
<meta name="description" content="Um sumário de teste." />
<meta name="keywords" content="kaggle, classificador, primeiros-passos">


<meta property="og:site_name" content="Robô Aprendiz"/>
<meta property="og:title" content="Meu Primeiro Classificador"/>
<meta property="og:description" content="Um sumário de teste."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="http://localhost:8000/meu-primeiro-classificador.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2020-03-22 12:00:00-03:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="http://localhost:8000/author/andre-thiago.html">
<meta property="article:section" content="machine learning"/>
<meta property="article:tag" content="kaggle"/>
<meta property="article:tag" content="classificador"/>
<meta property="article:tag" content="primeiros-passos"/>
<meta property="og:image" content="http://localhost:8000/images/artificial-intelligence.png">

  <title>Robô Aprendiz &ndash; Meu Primeiro Classificador</title>

</head>
<body>
  <aside>
    <div>
      <a href="http://localhost:8000">
        <img src="http://localhost:8000/images/artificial-intelligence.png" alt="Robô Aprendiz" title="Robô Aprendiz">
      </a>
      <h1><a href="http://localhost:8000">Robô Aprendiz</a></h1>

<p>Aprendizagem de máquina com técnicas de IA</p>      <nav>
        <ul class="list">


            <li><a target="_self" href="http://codeatest.com" >Sobre</a></li>
            <li><a target="_self" href="#" >Contato</a></li>
        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-You can add links in your config file" href="#" target="_blank">
            <i class="fab fa-You can add links in your config file">
            </i>
          </a></li>
          <li>
            <a  class="sc-Another social link" href="#" target="_blank">
            <i class="fab fa-Another social link">
            </i>
          </a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="http://localhost:8000">Início</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>


    </nav>

<article class="single">
  <header>
      
    <h1 id="meu-primeiro-classificador">Meu Primeiro Classificador</h1>
    <p>
      Publicado em dom 22 março 2020 na categoria <a href="http://localhost:8000/category/machine-learning.html">machine learning</a>

    </p>
  </header>


  <div>
    <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Introdu&#231;&#227;o">Introdu&#231;&#227;o<a class="anchor-link" href="#Introdu&#231;&#227;o">&#182;</a></h1><p>Vamos explorar aqui como criar um classificador básico utilizando o <em>dataset</em> <a href="https://www.kaggle.com/c/titanic">Titanic</a> do Kaggle. Esse é um problema de classificação simples, binária, onde devemos prever se um passageiro do navio irá ou não sobreviver, dado um conjunto de características (<em>features</em>) que ele possui (idade, sexo, porto de embarque etc.).</p>
<p>Nessa implementação vamos utilizar a biblioteca scikit-learn, com o classificador <a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html">RandomForest</a>.</p>
<p>A ideia é mostrar, numa abordagem top-down, como é rápida a criação de um classificador que prevê um resultado de um problema, sem muito conhecimento prévio, e já obtendo resultados minimamente aceitáveis.</p>
<p>Durante a solução do problemas, serão apresentados conceitos relacionados a implementação de um classificador em <em>Machine Learning</em>:</p>
<ul>
<li>exploração dos dados;</li>
<li>pré-processamento de dados</li>
<li>importância da separação dos <em>sets</em> de treino e validação;</li>
<li><em>overfitting</em>;</li>
<li>dentre outros.</li>
</ul>
<p>Vamos lá!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Bibliotecas-Utilizadas">Bibliotecas Utilizadas<a class="anchor-link" href="#Bibliotecas-Utilizadas">&#182;</a></h1><p>O código foi implementado em Python 3, utilizando as seguintes bibliotecas:</p>
<ul>
<li>pandas</li>
<li>scikit-learn</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># os dados estão na pasta data</span>

<span class="n">PATH</span> <span class="o">=</span> <span class="s2">&quot;data/&quot;</span>
<span class="o">!</span>ls <span class="o">{</span>PATH<span class="o">}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>test.csv  train.csv
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Iniciando-o-pr&#233;-processamento">Iniciando o pr&#233;-processamento<a class="anchor-link" href="#Iniciando-o-pr&#233;-processamento">&#182;</a></h1><p>Vamos ler os arquivos de treino e de teste. Ambos são arquivos <em>.csv</em>; geralmente, o Kaggle disponibiliza em seus problemas os arquivos de treino e teste separados, de forma que o modelo seja treinado e melhorado com os dados do arquivo de treino e validado junto aos dados do arquivo de teste.</p>
<p>Vamos utilizar um <a href="http://pandas.pydata.org/pandas-docs/version/0.19/generated/pandas.DataFrame.html">DataFrame</a> do <a href="https://pandas.pydata.org/">pandas</a>. No código abaixo, a saída do arquivo é direcionada para dois <em>DataFrames</em> distintos: df_train e df_test.</p>
<p><strong>Nota</strong>: Um <em>DataFrame</em> é uma estrutura de dados bidimensional, com linhas e colunas. Para efeitos de comparação, pense em <em>DataFrame</em> como uma tabela de um banco de dados relacional ou uma planilha.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{PATH}</span><span class="s1">train.csv&#39;</span><span class="p">)</span>
<span class="n">df_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{PATH}</span><span class="s1">test.csv&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Para facilitar o pré-processamento, vamos juntar os 2 <em>DataFrames</em> em um só. Isso costuma ser uma <strong>boa prática</strong>, pois, temos as seguintes vantagens:</p>
<ul>
<li>remoção de colunas: às vezes, optamos por remover uma coluna por algum motivo; ao retirar uma coluna dos dados de treino, precisamos também removê-la dos dados de teste (ambos os conjunto de dados precisam ter o mesmo conjunto de colunas - <em>features</em>, sob pena de termos um erro ao tentar construir o modelo);</li>
<li>remoção/tratamento uniforme de dados nulos;</li>
<li>consistência na criação de variáveis categóricas (se todas as categorias não estiverem presentes nos dois conjuntos de dados, elas podem ser codificadas de forma diferente se isso for feito em duas operações em separado) - isso vai ficar mais claro adiante;</li>
</ul>
<p>Portanto, juntar os 2 conjunto de dados uniformiza e padroniza o tratamento, de forma que o modelo criado lide de forma consistente nos dois casos.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_raw</span> <span class="o">=</span> <span class="n">df_train</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df_test</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">df_train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_test</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_raw</span><span class="p">)</span> <span class="c1"># listando o tamanho de cada um dos datasets</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[4]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(891, 418, 1309)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Vamos listar as colunas (<em>features</em>) presente em nosso <em>data set</em>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_raw</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[5]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;PassengerId&#39;, &#39;Survived&#39;, &#39;Pclass&#39;, &#39;Name&#39;, &#39;Sex&#39;, &#39;Age&#39;, &#39;SibSp&#39;,
       &#39;Parch&#39;, &#39;Ticket&#39;, &#39;Fare&#39;, &#39;Cabin&#39;, &#39;Embarked&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Vis&#227;o-geral-dos-dos-dados">Vis&#227;o geral dos dos dados<a class="anchor-link" href="#Vis&#227;o-geral-dos-dos-dados">&#182;</a></h3><p>Antes de começarmos a trabalhar com os dados, é bom termos uma visão geral dos dados.</p>
<p>Vamos dar uma olhada geral nos dados que temos.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_raw</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[6]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>191</th>
      <td>1083</td>
      <td>NaN</td>
      <td>1</td>
      <td>Salomon, Mr. Abraham L</td>
      <td>male</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>111163</td>
      <td>26.0000</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>549</th>
      <td>550</td>
      <td>1.0</td>
      <td>2</td>
      <td>Davies, Master. John Morgan Jr</td>
      <td>male</td>
      <td>8.00</td>
      <td>1</td>
      <td>1</td>
      <td>C.A. 33112</td>
      <td>36.7500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>99</th>
      <td>991</td>
      <td>NaN</td>
      <td>3</td>
      <td>Nancarrow, Mr. William Henry</td>
      <td>male</td>
      <td>33.00</td>
      <td>0</td>
      <td>0</td>
      <td>A./5. 3338</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>492</th>
      <td>493</td>
      <td>0.0</td>
      <td>1</td>
      <td>Molson, Mr. Harry Markland</td>
      <td>male</td>
      <td>55.00</td>
      <td>0</td>
      <td>0</td>
      <td>113787</td>
      <td>30.5000</td>
      <td>C30</td>
      <td>S</td>
    </tr>
    <tr>
      <th>701</th>
      <td>702</td>
      <td>1.0</td>
      <td>1</td>
      <td>Silverthorne, Mr. Spencer Victor</td>
      <td>male</td>
      <td>35.00</td>
      <td>0</td>
      <td>0</td>
      <td>PC 17475</td>
      <td>26.2875</td>
      <td>E24</td>
      <td>S</td>
    </tr>
    <tr>
      <th>78</th>
      <td>79</td>
      <td>1.0</td>
      <td>2</td>
      <td>Caldwell, Master. Alden Gates</td>
      <td>male</td>
      <td>0.83</td>
      <td>0</td>
      <td>2</td>
      <td>248738</td>
      <td>29.0000</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>106</th>
      <td>107</td>
      <td>1.0</td>
      <td>3</td>
      <td>Salkjelsvik, Miss. Anna Kristine</td>
      <td>female</td>
      <td>21.00</td>
      <td>0</td>
      <td>0</td>
      <td>343120</td>
      <td>7.6500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>470</th>
      <td>471</td>
      <td>0.0</td>
      <td>3</td>
      <td>Keefe, Mr. Arthur</td>
      <td>male</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>323592</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <th>6</th>
      <td>898</td>
      <td>NaN</td>
      <td>3</td>
      <td>Connolly, Miss. Kate</td>
      <td>female</td>
      <td>30.00</td>
      <td>0</td>
      <td>0</td>
      <td>330972</td>
      <td>7.6292</td>
      <td>NaN</td>
      <td>Q</td>
    </tr>
    <tr>
      <th>265</th>
      <td>1157</td>
      <td>NaN</td>
      <td>3</td>
      <td>Lyntakoff, Mr. Stanko</td>
      <td>male</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>349235</td>
      <td>7.8958</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A listagem acima é uma exibição <strong>aleatória</strong> (<em>sample(10)</em>) de 10 linhas; é interessante porque nos permite ter uma visão geral dos tipos dos dados que temos (numéricos, categóricos, textuais), presença de valores nulos etc.</p>
<p>Podemos visualizar, também, um <strong>sumário estatístico dos dados</strong>. Para isso, usamos o método <em>describe()</em> do <em>DataFrame</em>. Esse método nos retorna um outro DataFrame com diversas estatísticas: número de entradas, média, desvio-padrão, valor mínimo, valor máximo e percentis.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_raw</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1309.000000</td>
      <td>891.000000</td>
      <td>1309.000000</td>
      <td>1046.000000</td>
      <td>1309.000000</td>
      <td>1309.000000</td>
      <td>1308.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>655.000000</td>
      <td>0.383838</td>
      <td>2.294882</td>
      <td>29.881138</td>
      <td>0.498854</td>
      <td>0.385027</td>
      <td>33.295479</td>
    </tr>
    <tr>
      <th>std</th>
      <td>378.020061</td>
      <td>0.486592</td>
      <td>0.837836</td>
      <td>14.413493</td>
      <td>1.041658</td>
      <td>0.865560</td>
      <td>51.758668</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.170000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>328.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>21.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.895800</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>655.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>28.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.454200</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>982.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>39.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>31.275000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1309.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>80.000000</td>
      <td>8.000000</td>
      <td>9.000000</td>
      <td>512.329200</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Nota</strong>: colunas com valores não numéricos são excluídas dessa visualização (veja que a coluna <em>Name</em> não aparece, por exemplo).</p>
<p>Vamos listar as colunas com <strong>valores nulos</strong>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">df_raw</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df_raw</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[8]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Cabin          0.774637
Survived       0.319328
Age            0.200917
Embarked       0.001528
Fare           0.000764
Ticket         0.000000
Parch          0.000000
SibSp          0.000000
Sex            0.000000
Name           0.000000
Pclass         0.000000
PassengerId    0.000000
dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Das saídas anteriores, podemos tirar algumas conclusões:</p>
<ul>
<li>As colunas <em>Age</em>, <em>Cabin</em>, <em>Embarked</em> possuem valores nulos (<em>Survived</em> é a nossa variável dependente, isto é, o valor que queremos prever; esses valores nulos referem-se às entradas do arquivo de teste);</li>
<li>A coluna <em>Sex</em>, <em>Ticket</em> e <em>Embarked</em> devem ser categorizadas - os algoritmos de <em>Machine Learning</em> precisam de entradas do tipo numérico - não sabem lidar com texto;</li>
<li>As colunas <em>Name</em>  e <em>PassengerId</em>, em princípio, não fazem sentido. Provavelmente nossa variável dependente, <em>Survived</em>, não se relaciona com elas. Logo, podemos removê-las.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Tratando-os-nulos">Tratando os nulos<a class="anchor-link" href="#Tratando-os-nulos">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A maioria das bibliotecas de <em>Machine Learning</em>, incluindo a scikit-learn, disparam erros ao usar dados com valores nulos. Por isso precisamos tratar esses valores. Temos algumas alternativas:</p>
<ul>
<li><strong>remover as linhas</strong> com valores nulos (essa não costuma ser uma boa ideia, pois, estamos jogando fora linhas que possuem outras informações por causa de valores nulos em determinadas colunas);</li>
<li><strong>remover as colunas</strong> que possuem valores nulos (sob pena de perda de informação, caso elas sejam úteis);</li>
<li><strong><em>Imputation</em></strong>: preencher os valores nulos com algum valor; por exemplo, podemos substituir os nulos presentes em uma coluna pela média, mediana ou moda dos valores da coluna; esse procedimento nos dá um melhor resultado do que a simples remoção da coluna;</li>
</ul>
<p>Vamos usar as duas últimas alternativas acima.</p>
<p><strong>Nota</strong>: dado ao alto índice de valores nulos (77%), vamos optar por remover a coluna <em>Cabin</em>;</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_copy</span> <span class="o">=</span> <span class="n">df_raw</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_copy</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Cabin&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">df_copy</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[9]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;PassengerId&#39;, &#39;Survived&#39;, &#39;Pclass&#39;, &#39;Name&#39;, &#39;Sex&#39;, &#39;Age&#39;, &#39;SibSp&#39;,
       &#39;Parch&#39;, &#39;Ticket&#39;, &#39;Fare&#39;, &#39;Embarked&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Uma boa prática, antes de fazer os tratamentos necessários nos dados, é criar uma cópia dos dados originais, de forma que estes fiquem intactos. Foi isso que fizemos ao criar a variável <em>df_copy</em>.</p>
<p>Para as colunas <em>Age</em> e <em>Fare</em>, vamos colocar no lugar dos valores nulos a média das idades presentes.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">age_not_null</span> <span class="o">=</span> <span class="n">df_copy</span><span class="p">[</span><span class="n">df_copy</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">][</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span>
<span class="n">fare_not_null</span> <span class="o">=</span> <span class="n">df_copy</span><span class="p">[</span><span class="n">df_copy</span><span class="p">[</span><span class="s1">&#39;Fare&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">==</span> <span class="kc">False</span><span class="p">][</span><span class="s1">&#39;Fare&#39;</span><span class="p">]</span>
<span class="n">mean_age</span> <span class="o">=</span> <span class="n">age_not_null</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">mean_fare</span> <span class="o">=</span> <span class="n">fare_not_null</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">df_copy</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Age&#39;</span><span class="p">:</span><span class="n">mean_age</span><span class="p">,</span> <span class="s1">&#39;Fare&#39;</span> <span class="p">:</span> <span class="n">mean_fare</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># substituímos os nulos pela média</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Para a coluna <em>Embarked</em>, do tipo categórica, podemos usar a moda.</p>
<p>Vamos visualizar os dados presentes nessa coluna.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_copy</span><span class="p">[</span><span class="s1">&#39;Embarked&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fd982028290&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>O valor mais comun, a moda, é o valor 'S'. Vamos substituir os valores nulos por 'S'.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_copy</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Embarked&#39;</span><span class="p">:</span> <span class="s1">&#39;S&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Vamos ver agora os valores nulos que temos.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">df_copy</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df_copy</span><span class="p">))</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Survived       0.319328
Embarked       0.000000
Fare           0.000000
Ticket         0.000000
Parch          0.000000
SibSp          0.000000
Age            0.000000
Sex            0.000000
Name           0.000000
Pclass         0.000000
PassengerId    0.000000
dtype: float64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pronto. Tratamos todos os nulos. Podemos prosseguir com o pré-processamento de dados.</p>
<p><strong>Nota</strong>: lembre-se que a coluna <em>Survived</em> tem valores nulos provenientes dos dados do arquivo de teste - é o que vamos prever.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Lidando-com-vari&#225;veis-categ&#243;ricas">Lidando com vari&#225;veis categ&#243;ricas<a class="anchor-link" href="#Lidando-com-vari&#225;veis-categ&#243;ricas">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Variáveis categóricas são aquelas cujos valores são limitados a um conjunto de valores. Um exemplo de variável categórica em nosso conjunto de dados é <em>Embarked</em>, que representa o porto de embarque; os seus valores são 'S', 'C' e 'Q'.</p>
<p>Assim como no caso dos valores nulos, passar variáveis categóricas para modelos de <em>Machine Learning</em> também resultam em erros. Por isso precisamos tratar esses valores.</p>
<p>A forma mais popular de tratamento de variáveis categóricas é o <strong>One-Hot Encoding</strong>.</p>
<p><strong>One-Hot Encoding</strong> cria novas colunas, binárias, indicando a presença ou ausência de cada um dos valores categóricos no conjunto de dados original. É uma boa técnica quando o conjunto de valores categóricos não é muito grande - caso contrário, vamos ter uma explosão de colunas.</p>
<p>Primeiramente, vamos visualizar os tipos de dados de cada uma das nossas colunas (<em>features</em>).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_copy</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[14]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>PassengerId      int64
Survived       float64
Pclass           int64
Name            object
Sex             object
Age            float64
SibSp            int64
Parch            int64
Ticket          object
Fare           float64
Embarked        object
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As variáveis do tipo <strong>object</strong> indicam que elas possuem texto. Essas, em geral, são colunas que devem passar pelo processo de <em>encoding</em>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Vamos verificar a quantidade de valores únicos em cada uma dessas colunas object.</span>
<span class="n">unique_values</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df_copy</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">df_copy</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">:</span>
        <span class="n">unique_values</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_copy</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
        
<span class="n">unique_values</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[15]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{&#39;Name&#39;: 1307, &#39;Sex&#39;: 2, &#39;Ticket&#39;: 929, &#39;Embarked&#39;: 3}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Se fizemos <em>one-hot encoding</em> diretamente, as colunas <em>Name</em> e <em>Ticket</em> vão gerar diversas colunas binárias. Logo, não é uma boa ideia usar o encoding nelas.</p>
<p>Primeiramente, vamos ignorar a coluna <em>Name</em>. Vamos fazer isso porque o hot-encoding dela geraria uma explosão de colunas; e, também, porque conforme dissemos anteriomente, acreditamos que ela não deve estar relacionada com a variável alvo, não devendo ter, portanto, importância para o modelo (o nome da pessoa não deve influenciar se ela sobrevive ou não).</p>
<p>Depois, vamos categorizar as variáveis <em>Ticket</em> e <em>Sex</em>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_copy</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_copy</span><span class="o">.</span><span class="n">columns</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[16]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>Index([&#39;PassengerId&#39;, &#39;Survived&#39;, &#39;Pclass&#39;, &#39;Sex&#39;, &#39;Age&#39;, &#39;SibSp&#39;, &#39;Parch&#39;,
       &#39;Ticket&#39;, &#39;Fare&#39;, &#39;Embarked&#39;],
      dtype=&#39;object&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Transformamos texto em categoria</span>
<span class="n">df_copy</span><span class="p">[</span><span class="s1">&#39;Ticket&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_copy</span><span class="p">[</span><span class="s1">&#39;Ticket&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="n">df_copy</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_copy</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;category&#39;</span><span class="p">)</span>
<span class="c1"># Substitui os valores pelos códigos de cada categoria</span>
<span class="n">df_copy</span><span class="p">[</span><span class="s1">&#39;Ticket&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_copy</span><span class="p">[</span><span class="s1">&#39;Ticket&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>
<span class="n">df_copy</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_copy</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">cat</span><span class="o">.</span><span class="n">codes</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_copy</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[18]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>416</th>
      <td>417</td>
      <td>1.0</td>
      <td>2</td>
      <td>0</td>
      <td>34.000000</td>
      <td>1</td>
      <td>1</td>
      <td>305</td>
      <td>32.5000</td>
      <td>S</td>
    </tr>
    <tr>
      <th>568</th>
      <td>569</td>
      <td>0.0</td>
      <td>3</td>
      <td>1</td>
      <td>29.881138</td>
      <td>0</td>
      <td>0</td>
      <td>281</td>
      <td>7.2292</td>
      <td>C</td>
    </tr>
    <tr>
      <th>47</th>
      <td>939</td>
      <td>NaN</td>
      <td>3</td>
      <td>1</td>
      <td>29.881138</td>
      <td>0</td>
      <td>0</td>
      <td>640</td>
      <td>7.7500</td>
      <td>Q</td>
    </tr>
    <tr>
      <th>281</th>
      <td>1173</td>
      <td>NaN</td>
      <td>3</td>
      <td>1</td>
      <td>0.750000</td>
      <td>1</td>
      <td>1</td>
      <td>883</td>
      <td>13.7750</td>
      <td>S</td>
    </tr>
    <tr>
      <th>362</th>
      <td>363</td>
      <td>0.0</td>
      <td>3</td>
      <td>0</td>
      <td>45.000000</td>
      <td>0</td>
      <td>1</td>
      <td>286</td>
      <td>14.4542</td>
      <td>C</td>
    </tr>
    <tr>
      <th>358</th>
      <td>359</td>
      <td>1.0</td>
      <td>3</td>
      <td>0</td>
      <td>29.881138</td>
      <td>0</td>
      <td>0</td>
      <td>381</td>
      <td>7.8792</td>
      <td>Q</td>
    </tr>
    <tr>
      <th>214</th>
      <td>215</td>
      <td>0.0</td>
      <td>3</td>
      <td>1</td>
      <td>29.881138</td>
      <td>1</td>
      <td>0</td>
      <td>611</td>
      <td>7.7500</td>
      <td>Q</td>
    </tr>
    <tr>
      <th>702</th>
      <td>703</td>
      <td>0.0</td>
      <td>3</td>
      <td>0</td>
      <td>18.000000</td>
      <td>0</td>
      <td>1</td>
      <td>286</td>
      <td>14.4542</td>
      <td>C</td>
    </tr>
    <tr>
      <th>190</th>
      <td>191</td>
      <td>1.0</td>
      <td>2</td>
      <td>0</td>
      <td>32.000000</td>
      <td>0</td>
      <td>0</td>
      <td>156</td>
      <td>13.0000</td>
      <td>S</td>
    </tr>
    <tr>
      <th>58</th>
      <td>59</td>
      <td>1.0</td>
      <td>2</td>
      <td>0</td>
      <td>5.000000</td>
      <td>1</td>
      <td>2</td>
      <td>768</td>
      <td>27.7500</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Como podemos ver, as variáveis <em>Ticket</em> e <em>Sex</em> tiveram seus valores substituídos pelos códigos numéricos correspondentes.</p>
<p>Agora, finalmente, vamos aplicar o one-hot encoding no DataFrame.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_copy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df_copy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A função <em>get_dummies</em> do pandas permite fazer <em>one-hot encoding</em>, convertendo variáveis categóricas em variáveis indicadores (<em>dummy</em>).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_copy</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[20]:</div>



<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Embarked_C</th>
      <th>Embarked_Q</th>
      <th>Embarked_S</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>849</th>
      <td>850</td>
      <td>1.0</td>
      <td>1</td>
      <td>0</td>
      <td>29.881138</td>
      <td>1</td>
      <td>0</td>
      <td>108</td>
      <td>89.1042</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>257</th>
      <td>1149</td>
      <td>NaN</td>
      <td>3</td>
      <td>1</td>
      <td>28.000000</td>
      <td>0</td>
      <td>0</td>
      <td>586</td>
      <td>8.0500</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>551</th>
      <td>552</td>
      <td>0.0</td>
      <td>2</td>
      <td>1</td>
      <td>27.000000</td>
      <td>0</td>
      <td>0</td>
      <td>196</td>
      <td>26.0000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>237</th>
      <td>1129</td>
      <td>NaN</td>
      <td>3</td>
      <td>1</td>
      <td>20.000000</td>
      <td>0</td>
      <td>0</td>
      <td>274</td>
      <td>7.2250</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>609</th>
      <td>610</td>
      <td>1.0</td>
      <td>1</td>
      <td>0</td>
      <td>40.000000</td>
      <td>0</td>
      <td>0</td>
      <td>805</td>
      <td>153.4625</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>706</th>
      <td>707</td>
      <td>1.0</td>
      <td>2</td>
      <td>0</td>
      <td>45.000000</td>
      <td>0</td>
      <td>0</td>
      <td>140</td>
      <td>13.5000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>580</th>
      <td>581</td>
      <td>1.0</td>
      <td>2</td>
      <td>0</td>
      <td>25.000000</td>
      <td>1</td>
      <td>1</td>
      <td>175</td>
      <td>30.0000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>204</th>
      <td>1096</td>
      <td>NaN</td>
      <td>2</td>
      <td>1</td>
      <td>25.000000</td>
      <td>0</td>
      <td>0</td>
      <td>765</td>
      <td>10.5000</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>244</th>
      <td>245</td>
      <td>0.0</td>
      <td>3</td>
      <td>1</td>
      <td>30.000000</td>
      <td>0</td>
      <td>0</td>
      <td>289</td>
      <td>7.2250</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>169</th>
      <td>1061</td>
      <td>NaN</td>
      <td>3</td>
      <td>0</td>
      <td>22.000000</td>
      <td>0</td>
      <td>0</td>
      <td>696</td>
      <td>8.9625</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Compare essa saída com a saída do penúltimo <em>sample()</em>.</p>
<p>Observe, nessa última saída, que foram criadas variáveis adicionais derivadas de <em>Embarked</em>:</p>
<ul>
<li><em>Embarked_C</em>: indicando que o valor original era 'C';</li>
<li><em>Embarked_Q</em>: indicando que o valor original era 'Q';</li>
<li><em>Embarked_S</em>: indicando que o valor original era 'S';</li>
</ul>
<p>Em cada linha, somente uma dessas variáveis terá seu valor igual a 1, com as outras tendo o valor 0.</p>
<p>Agora, com todas as variáveis tendo valores numéricos, podemos partir para o treino do modelo.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Treinando-um-modelo">Treinando um modelo<a class="anchor-link" href="#Treinando-um-modelo">&#182;</a></h1><p>Finalmente podemos treinar o modelo. Vamos, primeiramente, separar novamente os data sets de treino e teste, conforme os arquivos originalmente nos fornecidos pelo Kaggle.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span> <span class="o">=</span> <span class="n">df_copy</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">891</span><span class="p">]</span> <span class="c1"># o tamanho original do arquivo de treino é 891</span>
<span class="n">df_test</span> <span class="o">=</span> <span class="n">df_copy</span><span class="p">[</span><span class="mi">891</span><span class="p">:]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A partir de agora, vamos utilizar o conjunto de treino para fazer o treino do nosso modelo.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Definindo-as-features">Definindo as features<a class="anchor-link" href="#Definindo-as-features">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cols_to_remove</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PassengerId&#39;</span><span class="p">,</span> <span class="s1">&#39;Survived&#39;</span><span class="p">]</span>

<span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">df_train</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cols_to_remove</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[&#39;Pclass&#39;, &#39;Sex&#39;, &#39;Age&#39;, &#39;SibSp&#39;, &#39;Parch&#39;, &#39;Ticket&#39;, &#39;Fare&#39;, &#39;Embarked_C&#39;, &#39;Embarked_Q&#39;, &#39;Embarked_S&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>No trecho anterior removemos as variáveis <em>PassengerId</em> (pelo fato de acreditarmos que ela não se relaciona com a nossa variável alvo - é apenas um sequencial numérico) e a variável alvo <em>Survived</em>. O objetivo é selecionar as <em>features</em> que vamos utilizar para treinar nosso modelo.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Usando-o-RandomForestClassifier">Usando o RandomForestClassifier<a class="anchor-link" href="#Usando-o-RandomForestClassifier">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="c1"># usando n_estimators = 100, para suprimir warning</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="n">features</span><span class="p">],</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[23]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(bootstrap=True, ccp_alpha=0.0, class_weight=None,
                       criterion=&#39;gini&#39;, max_depth=None, max_features=&#39;auto&#39;,
                       max_leaf_nodes=None, max_samples=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, n_estimators=100,
                       n_jobs=None, oob_score=False, random_state=42, verbose=0,
                       warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>No trecho anterior, criamos um classificador do tipo RandomForest e em seguida chamamos o seu método <em>fit</em>, para fazer o <strong>treino</strong> do modelo - a construção das árvores, neste caso.</p>
<p>COLOCAR LINK RANDOM FOREST</p>
<p>O primeiro argumento de <em>fit</em> é a entrada para o treino (X); o segundo argumento é a variável alvo (y).</p>
<p>Agora vamos fazer a <strong>previsão</strong> do resultado.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A função <em>predict()</em> nos retorna os valores que queremos prever, neste caso, o valor de <em>Survived</em>.</p>
<p>Esse é o padrão para treino de modelos utilizando scikit-learn: chamar <em>fit</em> para fazer o ajuste e depois <em>predict</em> para fazer a previsão.</p>
<p>FIGURA FIT-PREDICT</p>
<p>Vamos ver a acurácia das nossas previsões no dataset de treino.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>

<span class="n">accuracy_score</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">],</span> <span class="n">train_predictions</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[25]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.9988776655443322</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Usamos como métrica a acurácia - essa é a métrica recomendada pelo Kaggle para esse problema. Fizemos uso do <em>accuracy_score</em> do scikit-learn; o seu primeiro argumento são os valores reais; o segundo argumento são os valores previstos, obtidos como saída do classificador.</p>
<p>Nesse caso, o modelo está conseguindo acertar 99% das previsões.</p>
<p>O que fizemos até agora nos garante que o nosso modelo tem um ótimo desempenho nos dados do conjunto de treino - quase 100%. Esse são os dados conhecidos.</p>
<p>No entanto, precisamos garantir que o modelo também se comporte bem para dados que ele ainda não conhece; em outras palavras, queremos um modelo/classificador que generalize bem para novos dados que lhe sejam apresentados - evitar o <strong><em>overfitting</em></strong>.</p>
<p>Para avaliar quão bom é o desempenho do modelo treinado em dados desconhecidos, vamos separar o conjunto de dados de treino em 2 outros conjuntos separados: treino e teste.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="train_test_split:-Criando-os-conjuntos-de-treino-e-teste">train_test_split: Criando os conjuntos de treino e teste<a class="anchor-link" href="#train_test_split:-Criando-os-conjuntos-de-treino-e-teste">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="n">features</span><span class="p">],</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">],</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">42</span><span class="p">)</span>
<span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[28]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>((712, 10), (179, 10), (712,), (179,))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Fizemos uso da função <em>train_test_split</em> do scikit-learn para separar, aleatoriamente, o dataset de treino df_train em outros dois datasets independentes: X_train e X_test (80% dos dados vão ser usados para o treino; 20% para fazer o teste/validação do modelo).</p>
<p>Agora, vamos treinar o modelo utilizando o X_train e avaliá-lo utilizando o X_test.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)),</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[29]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(0.9985955056179775, 0.8044692737430168)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Como vemos, o desempenho no set de treino é bem maior do que no set de teste: 99% vs 80% - embora precisão de 80% seja um resultado razoável. O que está ocorrendo aqui é o <strong><em>overfitting</em></strong>.</p>
<p>O <strong><em>overfitting</em></strong> ocorre quando o modelo captura bem as características presentes no set de treinamento, mas falha ao generalizar seu comportamento para dados que ele desconhece - fazendo uma analogia, é como se ele decorasse as características existentes, em vez de aprendê-las.</p>
<p>Há diversas formas de tratar o overfitting, como melhora de hiperparâmetros, melhor tratamento de dados, etc. Não vamos entrar nesse tópico, para não fugir do nosso objetivo, que é a criação de um classificador simples e rápido.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Verificando-se-o-classificador-criado-&#233;-bom">Verificando se o classificador criado &#233; bom<a class="anchor-link" href="#Verificando-se-o-classificador-criado-&#233;-bom">&#182;</a></h3><p>Vimos que o classificador tem uma acurácia de 80% no dataset de teste. 80%, para a maioria dos problemas, parece ser um bom resultado. Mas quão bom é esse valor?</p>
<p>Vamos comparar o nosso classificador com um classificador que <em>dummy</em>, isto é, um classificador que sempre prevê o mesmo valor (por exemplo, ele sempre "chuta" que o passageiro vai morrer). Esperamos que o nosso classificador seja melhor que esse, caso contrário, não faz sentido utilizá-lo.</p>
<p>Vamos dar uma olhada nos nossos dados.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[30]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fd97ed65650&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Vamos fazer um classificador que, independentemente dos dados, sempre chuta que o passageiro vai morrer.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.dummy</span> <span class="kn">import</span> <span class="n">DummyClassifier</span>

<span class="c1"># cria um classificador que faz previsões baseados na classe mais frequente</span>
<span class="n">dummy</span> <span class="o">=</span> <span class="n">DummyClassifier</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;most_frequent&quot;</span><span class="p">)</span>
<span class="n">dummy</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">dummy</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)),</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">dummy</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[31]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(0.6235955056179775, 0.5865921787709497)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Conforme podemos ver, a acurácia do classificador que sempre prevê o mesmo valor, é de 58.6% nos dados de teste. Logo, o nosso classificador baseado em RandomForest está bem melhor que esse.</p>
<p>Vamos fazer a análise final, que seria a submissão dos resultados para o Kaggle, baseado no arquivo com os dados de testes que nos foi fornecido (test.csv).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Resultado-junto-ao-arquivo-de-teste">Resultado junto ao arquivo de teste<a class="anchor-link" href="#Resultado-junto-ao-arquivo-de-teste">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">output_predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df_test</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">output_predictions</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 0. 1. 0. 1. 1. 0. 0. 0. 1. 0. 0. 1. 0.
 1. 0. 1. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 0. 0. 0.
 1. 1. 1. 0. 1. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 1. 1. 0. 0. 1. 1. 0.
 0. 0. 1. 0. 0. 1. 0. 1. 1. 0. 0. 0. 0. 0. 1. 0. 1. 1. 0. 0. 1. 0. 0. 0.
 1. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 1. 1. 0. 1. 0. 0. 1. 0. 1.
 1. 0. 1. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0.
 1. 0. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0.
 1. 0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 0. 0. 1. 0. 1. 0. 1. 0. 0. 0. 0. 0.
 0. 0. 1. 0. 1. 0. 0. 0. 1. 1. 0. 1. 0. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 0.
 1. 0. 1. 0. 1. 0. 1. 0. 1. 1. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 1. 0. 1. 1.
 1. 1. 0. 0. 0. 0. 1. 0. 1. 0. 1. 0. 1. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 1.
 0. 0. 0. 0. 0. 0. 1. 0. 1. 1. 0. 1. 0. 0. 0. 0. 0. 1. 1. 1. 1. 0. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 1. 1. 1. 0. 0. 0. 0.
 0. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0.
 0. 0. 0. 0. 0. 0. 0. 1. 0. 1. 0. 1. 0. 1. 1. 0. 0. 0. 1. 0. 1. 0. 0. 1.
 0. 1. 1. 0. 1. 0. 0. 0. 1. 1. 0. 1. 0. 0. 1. 1. 0. 0. 0. 1. 0. 0. 1. 1.
 0. 1. 0. 0. 0. 0. 1. 1. 0. 0. 0. 1. 0. 1. 0. 0. 1. 0. 1. 0. 0. 0. 0. 0.
 1. 1. 1. 1. 0. 0. 1. 0. 0. 0.]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_submission</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;PassengerId&#39;</span><span class="p">:</span> <span class="n">df_test</span><span class="p">[</span><span class="s1">&#39;PassengerId&#39;</span><span class="p">],</span> <span class="s1">&#39;Survived&#39;</span><span class="p">:</span> <span class="n">output_predictions</span><span class="p">})</span>
<span class="n">my_submission</span><span class="o">.</span><span class="n">Survived</span> <span class="o">=</span> <span class="n">my_submission</span><span class="o">.</span><span class="n">Survived</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># escrevendo o arquivo de saída</span>
<span class="n">my_submission</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{PATH}</span><span class="s1">submission.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pronto. O arquivo está pronto para ser enviado para o Kaggle.</p>
<p><strong>Nota</strong>: A título de curiosidade, o score desse classificador no Kaggle foi 0.7751. Ou seja, acurácia de 77.5%. Cabe lembrar que não fizemos nenhuma otimização no nosso classificador. Apenas tratamos os dados e fizemos a classificação. Então é um resultado bastante aceitável para uma primeira experiência.</p>

</div>
</div>
</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

  </div>
  <div class="tag-cloud">
    <p>
      <a href="http://localhost:8000/tag/kaggle.html">kaggle</a>
      <a href="http://localhost:8000/tag/classificador.html">classificador</a>
      <a href="http://localhost:8000/tag/primeiros-passos.html">primeiros-passos</a>
    </p>
  </div>





</article>

    <footer>
<p>&copy;  </p>
<p>Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Robô Aprendiz ",
  "url" : "http://localhost:8000",
  "image": "http://localhost:8000/images/artificial-intelligence.png",
  "description": "Robô Aprendiz - Aprendizagem de máquina com técnicas de IA"
}
</script>


</body>
</html>